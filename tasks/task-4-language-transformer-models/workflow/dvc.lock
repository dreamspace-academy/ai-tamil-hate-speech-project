schema: '2.0'
stages:
  train_eval:
    cmd: python train_eval.py
    deps:
    - path: ../data/hate-speech-homophobia/dev_data.csv
      md5: c908b2c85ee2b44d9af0b1d2ae2cad6c
      size: 108838
    - path: ../data/hate-speech-homophobia/test_data.csv
      md5: 314e0d1a0d67ebb3370e8d47c1584400
      size: 97534
    - path: ../data/hate-speech-homophobia/train_data.csv
      md5: 8faa7f3fc4a6b356ecb2026dee599fda
      size: 904786
    - path: params.yaml
      md5: aac3b7e2b1216820f86d816cc31689a7
      size: 762
    - path: train_eval.py
      md5: bd09043d00aa0e6c8cbf26357ae1009c
      size: 8431
    outs:
    - path: model_artifacts/args.pt
      md5: 452cd929ddeb040951ee2fb636f621d6
      size: 1455
    - path: model_artifacts/model_best.pt
      md5: adda4f42740e353a7e22bb96667d9af4
      size: 952692063
    - path: model_artifacts/test_labels.txt
      md5: 72cf4d8023dc267d0ba0d192bf69f769
      size: 27
    - path: model_artifacts/test_labels_gold.txt
      md5: b26c2e8176e929ce01acc9aba26dc012
      size: 663
    - path: model_artifacts/test_labels_pred.txt
      md5: 988608c0b8a7b2c8d4c4faae7e0fd7b9
      size: 1327
    - path: model_artifacts/test_labels_prob_pred.txt
      md5: 2c8cb4889b0b18cc1429eee8b1a2f738
      size: 5530
    - path: model_artifacts/test_pr_values.txt
      md5: 01b552a7b5072d2a173279403ede5812
      size: 7131
  train_k_fold:
    cmd: python train_k_fold.py
    deps:
    - path: ../data/hate-speech-homophobia/train_data.csv
      md5: 8faa7f3fc4a6b356ecb2026dee599fda
      size: 904786
    - path: train_k_fold.py
      md5: e9c6748695b46b62b1ae30862412bac1
      size: 10753
    params:
      params.yaml:
        batch_size: 16
        class_threshold: 0.2
        dataset: hate-speech-homophobia
        dev_filename: hate-speech-homophobia/dev_data.csv
        es_patience: 3
        gradient_accumulation_steps: 8
        hidden_size: 768
        label_smoothing: 0.2
        labels:
        - Non-Hate-Speech
        - Hate-Speech
        loss_type: ce
        lr: 3e-05
        lr_factor: 0.5
        lr_patience: 1
        max_epochs: 10
        max_length: 256
        model_path: google/muril-base-cased
        num_workers: 2
        number_folds: 5
        seed: 1111
        task_name: hate_speech_binary_classification
        test_filename: hate-speech-homophobia/test_data.csv
        train_filename: hate-speech-homophobia/train_data.csv
        tunning_metric: Recall
        use_fp16: true
    outs:
    - path: cv_results.json
      md5: f3e515f6e6e51f6f86a3166485cea1d5
      size: 292
